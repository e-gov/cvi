@mixin cvi-dropdown-popup($base: &) {
  --comment: 'A popup for an list-based dropdown';

  --bg-color-focused: #{get-color(sapphire-blue-8)};
  --bg-color-current: #{get-color(sapphire-blue-10)};

  position: absolute;
  width: 100%;
  background-color: get-color(white);
  border-bottom-left-radius: var(--cvi-radius-s);
  border-bottom-right-radius: var(--cvi-radius-s);
  border: 1px solid get-color(black-coral-3);
  z-index: get-z-index('dropdown-popup', 'dropdown');
  max-height: 300px;
  overflow-y: auto;

  @at-root {
    #{$base}__dropdown-item {
      padding: get-spacing('rapla') get-spacing('elva');
      cursor: pointer;
      color: get-color(black-coral-18);

      &.is-current {
        background-color: var(--bg-color-current);
        color: get-color(white);

        &:hover {
          background-color: var(--bg-color-focused);
        }
      }

      &.multiselect-is-current {
        background-color: get-color(white);
      }

      &.is-focused,
      &.is-focused:hover {
        background-color: var(--bg-color-focused);
        color: get-color(white);
      }

      &:hover {
        background-color: get-color(sapphire-blue-0);
      }

      #{$base}__item-checkbox {
        -webkit-appearance: none;
        appearance: none;
        border-radius: var(--cvi-radius-s);
        margin-right: get-spacing('paldiski');
        outline: none;
        cursor: pointer;
        width: 24px;
        height: 24px;
        border: 1px solid var(--cvi-color-black-coral-8);

        margin-top: 0.19em;

        &.checked {
          border: 1px solid var(--cvi-color-sapphire-blue-10);
          background-image: none;
          background-color: var(--cvi-color-sapphire-blue-10);
          background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 10l3 3 6-6'/%3E%3C/svg%3E");
        }

        &.checked::before {
          content: '';
          position: absolute;
          box-shadow: 0 0 0 13px transparent;
          border-radius: 50%;
          width: 0.875rem;
          height: 0.875rem;
          background-color: transparent;
          opacity: 0;
          pointer-events: none;
          transform: scale(0);
        }

        &.checked::after {
          display: block;
          transform: rotate(45deg) /*!rtl:ignore*/;
          width: 0.375rem;
          height: 0.8125rem;
          border: 0.125rem solid #fff;
          border-top: 0;
          border-left: 0 /*!rtl:ignore*/;
          margin-left: 0.25rem;
          margin-top: -1px;
          background-color: transparent;
        }
      }
    }
  }
}
